<!doctype html>
<html xmlns:th="http://www.thymeleaf.org">

<head th:replace="fragments/head :: head('CRUD - ADMİN')"></head>

<body>
    <header>
        <div th:replace="~{fragments/navbar :: navbar}"></div>
    </header>
    <br>
    <br>
    <br>
    <div class="container my-5">
        <h2 class="text-center mb-4">CRUD İşlemleri</h2>
        <div class="accordion" id="crudAccordion">
            <!-- Kitap Ekle -->
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingAdd">
                    <button class="accordion-button" type="button" data-bs-toggle="collapse"
                        data-bs-target="#collapseAdd" aria-expanded="true" aria-controls="collapseAdd">
                        Kitap Ekle
                    </button>
                </h2>
                <div id="collapseAdd" class="accordion-collapse collapse show" aria-labelledby="headingAdd"
                    data-bs-parent="#crudAccordion">
                    <div class="accordion-body">
                        <form action="/bookoperations/add" method="post" enctype="multipart/form-data">
                            <div class="mb-3">
                                <input type="text" name="title" class="form-control" placeholder="Kitap Adı" required>
                            </div>
                            <div class="mb-3">
                                <input type="text" name="author" class="form-control" placeholder="Yazar" required>
                            </div>
                            <div class="mb-3">
                                <input type="number" name="price" step="0.01" class="form-control" placeholder="Fiyat"
                                    required>
                            </div>
                            <div class="mb-3">
                                <input type="number" name="stock" class="form-control" placeholder="Stok" required>
                            </div>
                            <div class="mb-3">
                                <select name="categoryId" class="form-control">
                                    <option value="">Kategori Seçiniz</option>
                                    <option th:each="cat : ${categories}" th:value="${cat.id}" th:text="${cat.name}">
                                    </option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <input type="text" name="picture" class="form-control" placeholder="URL" required>
                            </div>
                            <button type="submit" class="btn btn-success w-100">Kitap Ekle</button>
                        </form>
                    </div>
                </div>
            </div>
            <!-- Kitap Güncelle -->
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingUpdate">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                        data-bs-target="#collapseUpdate" aria-expanded="false" aria-controls="collapseUpdate">
                        Kitap Güncelle
                    </button>
                </h2>
                <div id="collapseUpdate" class="accordion-collapse collapse" aria-labelledby="headingUpdate"
                    data-bs-parent="#crudAccordion">
                    <div class="accordion-body">
                        <form action="/bookoperations/update" method="post" enctype="multipart/form-data">
                            <div class="mb-3">
                                <input type="number" name="id" class="form-control" placeholder="Güncellenecek Kitap ID"
                                    required>
                            </div>
                            <div class="mb-3">
                                <input type="text" name="title" class="form-control" placeholder="Yeni Kitap Adı">
                            </div>
                            <div class="mb-3">
                                <input type="text" name="author" class="form-control" placeholder="Yeni Yazar">
                            </div>
                            <div class="mb-3">
                                <input type="number" name="price" step="0.01" class="form-control" placeholder="Fiyat">
                            </div>
                            <div class="mb-3">
                                <input type="number" name="stock" class="form-control" placeholder="Stok">
                            </div>
                            <div class="mb-3">
                                <select name="categoryId" class="form-control" required>
                                    <option value="">Kategori Seçiniz</option>
                                    <option th:each="cat : ${categories}" th:value="${cat.id}" th:text="${cat.name}">
                                    </option>
                                </select>
                            </div>
                            <div class="mb-3">
                                <input type="text" name="picture" class="form-control" placeholder="URL" required>
                            </div>
                            <button type="submit" class="btn btn-warning w-100">Güncelle</button>
                        </form>
                    </div>
                </div>
            </div>
            <!-- Kitap Sil -->
            <div class="accordion-item">
                <h2 class="accordion-header" id="headingDelete">
                    <button class="accordion-button collapsed" type="button" data-bs-toggle="collapse"
                        data-bs-target="#collapseDelete" aria-expanded="false" aria-controls="collapseDelete">
                        Kitap Sil
                    </button>
                </h2>
                <div id="collapseDelete" class="accordion-collapse collapse" aria-labelledby="headingDelete"
                    data-bs-parent="#crudAccordion">
                    <div class="accordion-body">
                        <form action="/bookoperations/delete" method="post">
                            <div class="mb-3">
                                <input type="number" name="id" class="form-control" placeholder="Silinecek Kitap ID"
                                    required>
                            </div>
                            <button type="submit" class="btn btn-danger w-100">Sil</button>
                        </form>
                    </div>
                </div>
            </div>
        </div>
        <!-- Kitap Listesi -->
        <div class="container my-5">
            <h3 class="text-center mb-4">Kitaplar Listesi</h3>
            <div class="table-responsive">
                <table class="table table-striped table-hover table-bordered align-middle">
                    <thead class="table-dark text-center">
                        <tr>
                            <th>ID</th>
                            <th>Kitap Adı</th>
                            <th>Yazar</th>
                            <th>Fiyat</th>
                            <th>Stok</th>
                            <th>Kategori Name</th>
                            <th>Fotoğraf</th>
                            <th>İşlem</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr th:each="book : ${books}">
                            <td th:text="${book.id}"></td>
                            <td th:text="${book.title}"></td>
                            <td th:text="${book.author}"></td>
                            <td th:text="${book.price}"></td>
                            <td th:text="${book.stock}"></td>
                            <td th:text="${book.category.name}"></td>
                            <td class="text-center">
                                <img th:src="${book.picture}" alt="Kitap Fotoğrafı" style="height:80px;">
                            </td>
                            <td>
                                <button type="button" class="btn btn-primary" data-bs-toggle="modal"
                                    data-bs-target="#kitapModal" th:attr="data-id=${book.id}, 
                   data-adi=${book.title}, 
                   data-yazar=${book.author},
                   data-fiyat=${book.price},
                   data-stok=${book.stock},
                   data-kategori=${book.categoryId},
                   data-foto=${book.picture}">
                                    Düzenle
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    <!-- footer start -->
    <div th:replace="fragments/footer :: footer"></div>
    <!-- footer end -->
    <div th:replace="fragments/scripts :: scripts"></div>
    <div th:replace="fragments/sepet :: sepetModal"></div>
    <div th:replace="fragments/bookModal :: bookModalUpdate"></div>
</body>

</html>